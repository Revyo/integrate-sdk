---
title: Anthropic Claude Integration
description: Use MCP tools with Anthropic's Claude API
---

The Integrate SDK provides seamless integration with Anthropic's Claude API, allowing Claude to access your integrations through MCP tools with the `useIntegrateAI` hook or `getAnthropicTools` on the server.

## Installation

```bash
bun add integrate-sdk @anthropic-ai/sdk
```

## Frontend Integration

Use the `useIntegrateAI` hook for automatic token injection:

```typescript
// app/providers.tsx
'use client';

import { createMCPClient, githubPlugin } from 'integrate-sdk';
import { useIntegrateAI } from 'integrate-sdk/react';

const client = createMCPClient({
  plugins: [
    githubPlugin({ clientId: process.env.NEXT_PUBLIC_GITHUB_CLIENT_ID! }),
  ],
});

export function Providers({ children }: { children: React.ReactNode }) {
  useIntegrateAI(client);
  return <>{children}</>;
}
```

## Server-Side Integration

### Setup Server Configuration

```typescript
// lib/integrate-server.ts
import { createMCPServer, githubPlugin } from 'integrate-sdk/server';

export const { client: serverClient } = createMCPServer({
  plugins: [
    githubPlugin({
      clientId: process.env.GITHUB_CLIENT_ID!,
      clientSecret: process.env.GITHUB_CLIENT_SECRET!,
      scopes: ['repo', 'user'],
    }),
  ],
});
```

### Create Chat API Route

```typescript
// app/api/chat/route.ts
import { serverClient } from '@/lib/integrate-server';
import { getAnthropicTools, handleAnthropicToolCalls } from 'integrate-sdk/integrations/anthropic';
import Anthropic from '@anthropic-ai/sdk';

const anthropic = new Anthropic({ apiKey: process.env.ANTHROPIC_API_KEY });

export async function POST(req: Request) {
  try {
    // Extract provider tokens from request
    const tokensHeader = req.headers.get('x-integrate-tokens');
    const providerTokens = JSON.parse(tokensHeader || '{}');

    // Get tools with user's tokens
    const tools = await getAnthropicTools(serverClient, { providerTokens });

    const { messages } = await req.json();

    // Create message with tools
    const message = await anthropic.messages.create({
      model: 'claude-3-5-sonnet-20241022',
      max_tokens: 1024,
      tools,
      messages,
    });

    // Handle any tool calls
    const toolResults = await handleAnthropicToolCalls(
      serverClient,
      message.content,
      { providerTokens }
    );

    // If there are tool results, continue the conversation
    if (toolResults.length > 0) {
      const finalMessage = await anthropic.messages.create({
        model: 'claude-3-5-sonnet-20241022',
        max_tokens: 1024,
        tools,
        messages: [
          ...messages,
          { role: 'assistant', content: message.content },
          { role: 'user', content: toolResults },
        ],
      });

      return Response.json(finalMessage);
    }

    return Response.json(message);
  } catch (error: any) {
    return Response.json(
      { error: error.message },
      { status: 500 }
    );
  }
}
```

## Complete Example

### Frontend Component

```typescript
// app/chat/page.tsx
'use client';

import { useState } from 'react';
import { createMCPClient, githubPlugin } from 'integrate-sdk';

const client = createMCPClient({
  plugins: [
    githubPlugin({ clientId: process.env.NEXT_PUBLIC_GITHUB_CLIENT_ID! }),
  ],
});

export default function ChatPage() {
  const [messages, setMessages] = useState<any[]>([]);
  const [input, setInput] = useState('');
  const [loading, setLoading] = useState(false);
  const [authorized, setAuthorized] = useState(false);

  const handleConnect = async () => {
    await client.authorize('github');
    setAuthorized(true);
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!input.trim()) return;

    const userMessage = { role: 'user', content: input };
    setMessages(prev => [...prev, userMessage]);
    setInput('');
    setLoading(true);

    try {
      const response = await fetch('/api/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          messages: [...messages, userMessage],
        }),
      });

      const data = await response.json();
      setMessages(prev => [...prev, { role: 'assistant', content: data.content }]);
    } catch (error) {
      console.error('Error:', error);
    } finally {
      setLoading(false);
    }
  };

  if (!authorized) {
    return (
      <div>
        <button onClick={handleConnect}>Connect GitHub</button>
      </div>
    );
  }

  return (
    <div>
      <h1>Claude with GitHub Access</h1>
      <div>
        {messages.map((m, i) => (
          <div key={i}>
            <strong>{m.role}:</strong> {JSON.stringify(m.content)}
          </div>
        ))}
      </div>
      <form onSubmit={handleSubmit}>
        <input
          value={input}
          onChange={(e) => setInput(e.target.value)}
          placeholder="Ask Claude to use GitHub..."
        />
        <button type="submit" disabled={loading}>
          {loading ? 'Thinking...' : 'Send'}
        </button>
      </form>
    </div>
  );
}
```

## API Reference

### `getAnthropicTools(client, options?)`

Converts all enabled MCP tools to Anthropic Claude API format.

**Parameters:**
- `client` - The MCP client instance
- `options` - Optional configuration
  - `providerTokens` - Provider tokens for server-side usage

**Returns:** `Promise<AnthropicTool[]>` - Array of tools ready for Claude API

### `handleAnthropicToolCalls(client, messageContent, options?)`

Handles all tool calls from Claude's message response.

**Parameters:**
- `client` - The MCP client instance
- `messageContent` - Array of content blocks from Claude's message
- `options` - Optional configuration with `providerTokens`

**Returns:** `Promise<AnthropicToolResultBlock[]>` - Tool results ready to send back to Claude

## Tool Format

Anthropic Claude expects tools in this format:

```typescript
{
  name: 'github_create_issue',
  description: 'Create a new issue in a GitHub repository',
  input_schema: {
    type: 'object',
    properties: {
      owner: { type: 'string' },
      repo: { type: 'string' },
      title: { type: 'string' },
      body: { type: 'string' }
    },
    required: ['owner', 'repo', 'title']
  }
}
```

## Next Steps

- [Set up OAuth routes in Next.js](/docs/oauth/nextjs)
- [Explore other AI providers](/docs/integrations/vercel-ai)
- [API Reference](/docs/reference/options)

