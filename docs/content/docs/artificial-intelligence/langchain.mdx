---
title: LangChain
description: Use MCP tools with LangChain's DynamicStructuredTool
---

The Integrate SDK provides seamless integration with LangChain, allowing you to use MCP tools with LangChain agents and chains.

## Installation

Install the Integrate SDK and LangChain packages:

```bash
bun add integrate-sdk @langchain/core @langchain/openai langchain
```

## Setup

Setting up LangChain integration requires **3 files** (or **5 files** if not using a database):

### 1. Server Configuration

Create a server configuration file with your OAuth credentials:

```typescript
// lib/integrate.ts
import { createMCPServer, githubIntegration } from "integrate-sdk/server";

export const { client: serverClient } = createMCPServer({
  apiKey: process.env.INTEGRATE_API_KEY,
  integrations: [
    githubIntegration({
      scopes: ["repo", "user"],
    }),
  ],
});
```

### 2. Providers (only if no database)

If you're not using a database, create a providers component that injects tokens:

```typescript
// app/providers.tsx
"use client";

import { client } from "integrate-sdk";
import { useIntegrateAI } from "integrate-sdk/react";

export function Providers({ children }: { children: React.ReactNode }) {
  useIntegrateAI(client);
  return <>{children}</>;
}
```

### 3. Layout (only if no database)

Wrap your app with the Providers component:

```typescript
// app/layout.tsx
import { Providers } from "./providers";

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body>
        <Providers>{children}</Providers>
      </body>
    </html>
  );
}
```

### 4. OAuth Handler

Create a catch-all route that handles OAuth operations at `app/api/integrate/[...all]/route.ts`:

```typescript
import { serverClient } from "@/lib/integrate";
import { toNextJsHandler } from "integrate-sdk/server";

export const { POST, GET } = toNextJsHandler(serverClient);
```

### 5. Agent API Route

Create an agent route that converts MCP tools to LangChain format:

```typescript
// app/api/agent/route.ts
import { serverClient } from "@/lib/integrate";
import { getLangChainTools } from "integrate-sdk/server";
import { DynamicStructuredTool } from "@langchain/core/tools";
import { ChatOpenAI } from "@langchain/openai";
import { AgentExecutor, createOpenAIFunctionsAgent } from "langchain/agents";
import { ChatPromptTemplate } from "@langchain/core/prompts";

export async function POST(req: Request) {
  const { message } = await req.json();

  const toolConfigs = await getLangChainTools(serverClient);
  const tools = toolConfigs.map((config) => new DynamicStructuredTool(config));

  const model = new ChatOpenAI({ temperature: 0, modelName: "gpt-4" });

  const prompt = ChatPromptTemplate.fromMessages([
    ["system", "You are a helpful assistant with access to GitHub."],
    ["human", "{input}"],
    ["placeholder", "{agent_scratchpad}"],
  ]);

  const agent = await createOpenAIFunctionsAgent({
    llm: model,
    tools,
    prompt,
  });

  const executor = new AgentExecutor({ agent, tools });
  const result = await executor.invoke({ input: message });

  return Response.json({ result: result.output });
}
```

## Usage

Use LangChain in any component:

```typescript
// app/page.tsx
"use client";

import { useState } from "react";
import { client } from "integrate-sdk";

export default function AgentPage() {
  const [message, setMessage] = useState("");
  const [result, setResult] = useState<string | null>(null);
  const [loading, setLoading] = useState(false);
  const [githubAuthorized, setGithubAuthorized] = useState(false);

  async function handleGithubClick() {
    try {
      if (githubAuthorized) {
        await client.disconnectProvider("github");
        setGithubAuthorized(false);
      } else {
        await client.authorize("github");
        setGithubAuthorized(true);
      }
    } catch (error) {
      console.error("Error:", error);
    }
  }

  async function handleSubmit(e: React.FormEvent) {
    e.preventDefault();
    if (!message.trim()) return;

    setLoading(true);

    try {
      const response = await fetch("/api/agent", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message }),
      });

      const data = await response.json();
      setResult(data.result);
    } catch (error) {
      console.error("Error:", error);
    } finally {
      setLoading(false);
    }
  }

  return (
    <div className="flex flex-col h-screen">
      <div className="flex-1 overflow-y-auto p-4">
        {result && (
          <div className="p-4 bg-gray-100 rounded-lg">
            <pre>{JSON.stringify(result, null, 2)}</pre>
          </div>
        )}
      </div>
      <form
        onSubmit={handleSubmit}
        className="p-4 border-t border-gray-500 space-y-2"
      >
        <input
          value={message}
          onChange={(e) => setMessage(e.target.value)}
          placeholder="Ask the agent anything..."
          className="w-full px-4 py-2 border border-gray-500 rounded-lg"
          disabled={loading}
        />
        <div className="flex justify-between">
          <button
            type="button"
            onClick={handleGithubClick}
            className="px-4 py-2 bg-black text-white rounded-lg disabled:opacity-50"
          >
            {githubAuthorized ? "Disconnect" : "Connect"} GitHub
          </button>
          <button
            type="submit"
            disabled={loading || !message.trim()}
            className="px-4 py-2 bg-black text-white rounded-lg disabled:opacity-50"
          >
            Run Agent
          </button>
        </div>
      </form>
    </div>
  );
}
```

## Next Steps

- Explore [Advanced Configuration](/docs/getting-started/advanced-usage)
- Check the [API Reference](/docs/reference/options) for complete type definitions
